$(info *GPU [mtk-Kbuild] building r38p1 DDK ...)

KO_CODE_PATH := $(if $(filter /%,$(src)),,$(srctree)/)$(src)

MTK_TOP = $(srctree)/drivers/misc/mediatek/

# build support for a ARM Mali Midgard GPU
CONFIG_MALI_MIDGARD := $(CONFIG_MTK_GPU_SUPPORT)

# use mtk platform
CONFIG_MALI_PLATFORM_NAME := $(MTK_PLATFORM)

ccflags-y += -I$(srctree)/include
ccflags-y += -I$(srctree)/drivers/staging/android
ccflags-y += -I$(srctree)/drivers/misc/mediatek/base/power/include
ccflags-y += -I$(srctree)/drivers/misc/mediatek/gpu/ged/include
ccflags-y += -I$(srctree)/drivers/misc/mediatek/sspm/v3
ccflags-y += -I$(srctree)/drivers/misc/mediatek/gpu/gpu_bm
ccflags-y += -I$(srctree)/drivers/misc/mediatek/include
ccflags-y += -I$(srctree)/drivers/gpu/mediatek/ged/include
ccflags-y += -I$(srctree)/drivers/gpu/mediatek/gpu_bm
ccflags-y += -I$(srctree)/drivers/gpu/mediatek/mt-plat
ccflags-y += -I$(srctree)/drivers/gpu/mediatek/gpufreq
ccflags-y += -I$(KO_CODE_PATH)/backend/gpu
ccflags-y += -I$(KO_CODE_PATH)/include
ccflags-y += -I$(KO_CODE_PATH)/platform/$(MTK_PLATFORM)
ccflags-y += -I$(KO_CODE_PATH)/platform/mtk_platform_common
ccflags-y += -I$(KO_CODE_PATH)/debug
ccflags-y += -I$(srctree)/drivers/staging/android/ion
ccflags-y += -I$(srctree)/drivers/iommu
ccflags-y += -I$(srctree)/drivers/misc/mediatek/include/mt-plat
ccflags-y += -I$(srctree)/drivers/misc/mediatek/sda/btm/v1
ifeq ($(CONFIG_MTK_TINYSYS_SSPM_SUPPORT), y)
ccflags-y += -I$(srctree)/drivers/misc/mediatek/sspm/
ccflags-y += -I$(srctree)/drivers/misc/mediatek/sspm/v3
ccflags-y += -I$(srctree)/drivers/misc/mediatek/qos/
endif

ccflags-$(CONFIG_DEBUG_FS) += -DCONFIG_DEBUG_FS
ccflags-$(CONFIG_PROC_FS) += -DCONFIG_PROC_FS
ccflags-$(CONFIG_MTK_GPU_COMMON_DVFS_SUPPORT) += -DCONFIG_MALI_MTK_DVFS_POLICY
ccflags-$(CONFIG_MTK_GPU_COMMON_DVFS_SUPPORT) += -DCONFIG_MALI_MTK_DVFS_LOADING_MODE
ccflags-y += -DCONFIG_GPU_$(shell echo $(MTK_PLATFORM) | tr a-z A-Z)
ccflags-y += -DCONFIG_MALI_MTK_COMMON
ccflags-y += -DCONFIG_MALI_MTK_PROTECTED_PATCH
ccflags-$(CONFIG_MALI_MIDGARD_DVFS) += -DCONFIG_MALI_MIDGARD_DVFS
ccflags-$(CONFIG_MALI_CSF_SUPPORT) += -DCONFIG_MALI_CSF_SUPPORT
ccflags-$(CONFIG_MALI_FENCE_DEBUG) += -DCONFIG_MALI_FENCE_DEBUG
ccflags-$(CONFIG_MALI_DEVFREQ) += -DCONFIG_MALI_DEVFREQ
ccflags-$(CONFIG_MALI_MTK_DEBUG) += -DCONFIG_MALI_MTK_DEBUG
ccflags-$(CONFIG_MALI_MTK_DEBUG_DFD) += -DCONFIG_MALI_MTK_DEBUG_DFD
ccflags-$(CONFIG_MALI_MTK_DIAGNOSIS_MODE) += -DCONFIG_MALI_MTK_DIAGNOSIS_MODE
ccflags-$(CONFIG_MALI_MTK_CM7_TRACE) += -DCONFIG_MALI_MTK_CM7_TRACE
ccflags-$(CONFIG_MALI_MTK_KE_DUMP_FWLOG) += -DCONFIG_MALI_MTK_KE_DUMP_FWLOG
ccflags-$(CONFIG_MALI_MTK_CSG_DOORBELL_RECOVERY) += -DCONFIG_MALI_MTK_CSG_DOORBELL_RECOVERY
ccflags-$(CONFIG_MTK_GPU_DIAGNOSIS_DEBUG) += -DCONFIG_MTK_GPU_DIAGNOSIS_DEBUG
ccflags-$(CONFIG_MALI_MTK_LOG_BUFFER) += -DCONFIG_MALI_MTK_LOG_BUFFER
ccflags-$(CONFIG_MALI_MTK_SYSFS) += -DCONFIG_MALI_MTK_SYSFS
ccflags-$(CONFIG_MALI_MTK_PROC_FS) += -DCONFIG_MALI_MTK_PROC_FS
ccflags-$(CONFIG_MALI_MTK_DEBUG_FS) += -DCONFIG_MALI_MTK_DEBUG_FS
ccflags-$(CONFIG_MALI_MTK_MEMTRACK) += -DCONFIG_MALI_MTK_MEMTRACK
ccflags-$(CONFIG_MALI_MTK_DEVFREQ_GOVERNOR) += -DCONFIG_MALI_MTK_DEVFREQ_GOVERNOR
ccflags-$(CONFIG_MALI_MTK_DEVFREQ_THERMAL) += -DCONFIG_MALI_MTK_DEVFREQ_THERMAL
ccflags-$(CONFIG_MALI_MTK_BRINGUP) += -DCONFIG_MALI_MTK_BRINGUP
ccflags-$(CONFIG_MALI_MTK_NO_THERMAL) += -DCONFIG_MALI_MTK_NO_THERMAL
ccflags-$(CONFIG_MALI_MTK_DUMMY_CM) += -DCONFIG_MALI_MTK_DUMMY_CM
ccflags-$(CONFIG_MALI_MTK_FENCE_DEBUG) += -DCONFIG_MALI_MTK_FENCE_DEBUG
ccflags-$(CONFIG_MALI_MTK_TIMEOUT_RESET) += -DCONFIG_MALI_MTK_TIMEOUT_RESET
ccflags-$(CONFIG_MALI_MTK_KCPU_DEBUG) += -DCONFIG_MALI_MTK_KCPU_DEBUG
ccflags-$(CONFIG_MALI_MTK_KCPU_FENCE_WA) += -DCONFIG_MALI_MTK_KCPU_FENCE_WA
ifeq ($(CONFIG_DEBUG_FS),y)
    ccflags-$(CONFIG_MALI_MTK_IRQ_DEBUG) += -DCONFIG_MALI_MTK_IRQ_DEBUG
endif
ccflags-$(CONFIG_MALI_MTK_MFGSYS_PM) += -DCONFIG_MALI_MTK_MFGSYS_PM
ifeq ($(CONFIG_MALI_CSF_SUPPORT),y)
    ccflags-$(CONFIG_MALI_MTK_GPU_BM_2) += -DCONFIG_MALI_MTK_GPU_BM_CSF
else
    ccflags-$(CONFIG_MALI_MTK_GPU_BM_2) += -DCONFIG_MALI_MTK_GPU_BM_JM
endif
ccflags-$(CONFIG_MALI_PMU_LP4) += -DCONFIG_MALI_PMU_LP4
ccflags-$(CONFIG_MALI_PMU_CPB128) += -DCONFIG_MALI_PMU_CPB128
ccflags-$(CONFIG_MALI_SCMI_ENABLE) += -DCONFIG_MALI_SCMI_ENABLE
ccflags-$(CONFIG_MALI_MTK_IDLE_HYSTERESIS_TIME) += -DCONFIG_MALI_MTK_IDLE_HYSTERESIS_TIME
ccflags-$(CONFIG_MALI_MTK_IRQ_TRACE) += -DCONFIG_MALI_MTK_IRQ_TRACE
ccflags-$(CONFIG_MALI_MTK_GPU_IDLE_TEST) += -DCONFIG_MALI_MTK_GPU_IDLE_TEST
ccflags-$(CONFIG_MALI_MTK_ACP_SVP_WA) += -DCONFIG_MALI_MTK_ACP_SVP_WA
ccflags-$(CONFIG_MALI_MTK_GLB_PWROFF_TIMEOUT) += -DCONFIG_MALI_MTK_GLB_PWROFF_TIMEOUT
ccflags-$(CONFIG_MALI_MTK_ACP_DSU_REQ) += -DCONFIG_MALI_MTK_ACP_DSU_REQ
ccflags-$(CONFIG_MALI_MTK_PENDING_SUBMISSION_MODE) += -DCONFIG_MALI_MTK_PENDING_SUBMISSION_MODE
ccflags-$(CONFIG_MALI_MTK_RECLAIM_POLICY) += -DCONFIG_MALI_MTK_RECLAIM_POLICY
# kernel config
$(info *GPU [mtk-Kbuild] CONFIG_DEBUG_FS = $(CONFIG_DEBUG_FS))
$(info *GPU [mtk-Kbuild] CONFIG_PROC_FS = $(CONFIG_PROC_FS))
$(info *GPU [mtk-Kbuild] CONFIG_MTK_GPU_COMMON_DVFS_SUPPORT = $(CONFIG_MTK_GPU_COMMON_DVFS_SUPPORT))
$(info *GPU [mtk-Kbuild] CONFIG_MTK_GPU_SUPPORT = $(CONFIG_MTK_GPU_SUPPORT))
$(info *GPU [mtk-Kbuild] CONFIG_MTK_GPU_VERSION = $(CONFIG_MTK_GPU_VERSION))

# platform config
$(info *GPU [mtk-Kbuild] MTK_GPU_VERSION = $(MTK_GPU_VERSION))
$(info *GPU [mtk-Kbuild] MTK_PLATFORM = $(MTK_PLATFORM))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MIDGARD = $(CONFIG_MALI_MIDGARD))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_PLATFORM_NAME = $(CONFIG_MALI_PLATFORM_NAME))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_CSF_SUPPORT = $(CONFIG_MALI_CSF_SUPPORT))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_REAL_HW = $(CONFIG_MALI_REAL_HW))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_NO_MALI = $(CONFIG_MALI_NO_MALI))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_DEBUG = $(CONFIG_MALI_DEBUG))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_FENCE_DEBUG = $(CONFIG_MALI_FENCE_DEBUG))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MIDGARD_DVFS = $(CONFIG_MALI_MIDGARD_DVFS))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_DEVFREQ = $(CONFIG_MALI_DEVFREQ))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_DEBUG = $(CONFIG_MALI_MTK_DEBUG))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_DEBUG_DFD = $(CONFIG_MALI_MTK_DEBUG_DFD))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_DIAGNOSIS_MODE = $(CONFIG_MALI_MTK_DIAGNOSIS_MODE))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_CM7_TRACE = $(CONFIG_MALI_MTK_CM7_TRACE))
$(info *GPU [mtk-Kbuild] CONFIG_MTK_GPU_DIAGNOSIS_DEBUG = $(CONFIG_MTK_GPU_DIAGNOSIS_DEBUG))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_LOG_BUFFER = $(CONFIG_MALI_MTK_LOG_BUFFER))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_KE_DUMP_FWLOG = $(CONFIG_MALI_MTK_KE_DUMP_FWLOG))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_CSG_DOORBELL_RECOVERY = $(CONFIG_MALI_MTK_CSG_DOORBELL_RECOVERY))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_SYSFS = $(CONFIG_MALI_MTK_SYSFS))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_PROC_FS = $(CONFIG_MALI_MTK_PROC_FS))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_DEBUG_FS = $(CONFIG_MALI_MTK_DEBUG_FS))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_MEMTRACK = $(CONFIG_MALI_MTK_MEMTRACK))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_DEVFREQ_GOVERNOR = $(CONFIG_MALI_MTK_DEVFREQ_GOVERNOR))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_DEVFREQ_THERMAL = $(CONFIG_MALI_MTK_DEVFREQ_THERMAL))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_GPU_BM_2 = $(CONFIG_MALI_MTK_GPU_BM_2))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_BRINGUP = $(CONFIG_MALI_MTK_BRINGUP))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_NO_THERMAL = $(CONFIG_MALI_MTK_NO_THERMAL))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_DUMMY_CM = $(CONFIG_MALI_MTK_DUMMY_CM))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_FENCE_DEBUG = $(CONFIG_MALI_MTK_FENCE_DEBUG))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_TIMEOUT_RESET = $(CONFIG_MALI_MTK_TIMEOUT_RESET))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_KCPU_DEBUG = $(CONFIG_MALI_MTK_KCPU_DEBUG))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_KCPU_FENCE_WA = $(CONFIG_MALI_MTK_KCPU_FENCE_WA))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_IRQ_DEBUG = $(CONFIG_MALI_MTK_IRQ_DEBUG))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_MFGSYS_PM = $(CONFIG_MALI_MTK_MFGSYS_PM))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_PMU_LP4 = $(CONFIG_MALI_PMU_LP4))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_PMU_CPB128 = $(CONFIG_MALI_PMU_CPB128))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_SCMI_ENABLE = $(CONFIG_MALI_SCMI_ENABLE))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_IDLE_HYSTERESIS_TIME = $(CONFIG_MALI_MTK_IDLE_HYSTERESIS_TIME))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_IRQ_TRACE = $(CONFIG_MALI_MTK_IRQ_TRACE))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_GPU_IDLE_TEST = $(CONFIG_MALI_MTK_GPU_IDLE_TEST))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_GLB_PWROFF_TIMEOUT = $(CONFIG_MALI_MTK_GLB_PWROFF_TIMEOUT))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_PENDING_SUBMISSION_MODE = $(CONFIG_MALI_MTK_PENDING_SUBMISSION_MODE))
$(info *GPU [mtk-Kbuild] CONFIG_MALI_MTK_RECLAIM_POLICY = $(CONFIG_MALI_MTK_RECLAIM_POLICY))
